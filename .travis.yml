language: cpp
os:
- linux
compiler:
- gcc
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-precise-3.7
    - george-edison55-precise-backports  # for cmake 3
    packages:
    - gcc-4.9
    - cmake
    - cmake-data

matrix:
  include:
    # works on Precise and Trusty
    - compiler: gcc
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-4.9
      env: COMPILER=g++-4.9

    # works on Precise and Trusty
    - compiler: gcc
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-5
      env: COMPILER=g++-5
    # works on Precise and Trusty
    - compiler: gcc
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - gcc-6
      env: COMPILER=g++-6

before_install:
    - eval "${MATRIX_EVAL}"

install:
- if [ "`echo $CXX`" == "g++" ]   && [ "$TRAVIS_OS_NAME" == "linux" ]; then export CXX=g++-4.9; fi
- if [ "`echo $CC`" == "gcc" ]   && [ "$TRAVIS_OS_NAME" == "linux" ]; then export CXX=gcc-4.9; fi
script:
- ./package.sh
before_deploy:
    - export RELEASE_FILE=$(bin.tar.gz)
    - ls
    - ls build
    - echo "Deploying $RELEASE_FILE to GitHub"
deploy:
  provider: releases
  api_key:
    secure: cb061a51e776f2fe17add85a0e0d55f20b0b54b9
  file: "${RELEASE_FILE}"
  skip_cleanup: true
  on:
    repo: BWISE
    tags: true
